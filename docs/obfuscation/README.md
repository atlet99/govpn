# GoVPN Traffic Obfuscation

–ú–æ–¥—É–ª—å –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞ GoVPN –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ DPI (Deep Packet Inspection) –∏ —Ü–µ–Ω–∑—É—Ä—ã –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö –º–∏—Ä–∞.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- **XOR Obfuscation** - –±—ã—Å—Ç—Ä–æ–µ XOR —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤–µ—Ä—Ö –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **TLS Tunneling** - –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è VPN —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ TLS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **HTTP Mimicry** - –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ VPN —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã/–æ—Ç–≤–µ—Ç—ã
- **Packet Padding** - —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è –∞–Ω—Ç–∏-—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ** - –¥–µ—Ç–µ–∫—Ç–æ—Ä DPI –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –º–µ—Ç–æ–¥–æ–≤
- **–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω (–ö–∏—Ç–∞–π, –ò—Ä–∞–Ω, –†–æ—Å—Å–∏—è)
- **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä–æ–≤
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è** - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### üöß –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
- **DNS Tunneling** - –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ DNS –∑–∞–ø—Ä–æ—Å—ã (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π –∫–∞–Ω–∞–ª)
- **Timing Obfuscation** - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
- **HTTP Steganography** - —Å–æ–∫—Ä—ã—Ç–∏–µ VPN –¥–∞–Ω–Ω—ã—Ö –≤ HTTP –∑–∞–ø—Ä–æ—Å–∞—Ö/–æ—Ç–≤–µ—Ç–∞—Ö

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ CLI

```bash
# –í–∫–ª—é—á–∏—Ç—å –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é —Å XOR –º–µ—Ç–æ–¥–æ–º
./govpn-server --obfuscation --obfuscation-method=xor_cipher

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –ö–∏—Ç–∞—è
./govpn-server --obfuscation --regional-profile=china

# –£–∫–∞–∑–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π XOR –∫–ª—é—á
./govpn-server --obfuscation --xor-key="my-secret-key-123"
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```go
package main

import (
    "log"
    "time"
    
    "github.com/atlet99/govpn/pkg/obfuscation"
)

func main() {
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏
    config := &obfuscation.Config{
        EnabledMethods:   []obfuscation.ObfuscationMethod{obfuscation.MethodXORCipher},
        PrimaryMethod:    obfuscation.MethodXORCipher,
        FallbackMethods:  []obfuscation.ObfuscationMethod{},
        AutoDetection:    true,
        SwitchThreshold:  3,
        DetectionTimeout: 5 * time.Second,
        RegionalProfile:  "china",
        XORKey:          []byte("your-secret-key"),
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –¥–≤–∏–∂–∫–∞ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏
    engine, err := obfuscation.NewEngine(config, log.Default())
    if err != nil {
        log.Fatal(err)
    }
    defer engine.Close()
    
    // –û–±—Ñ—É—Å–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    data := []byte("Sensitive VPN traffic")
    obfuscated, err := engine.ObfuscateData(data)
    if err != nil {
        log.Fatal(err)
    }
    
    // –î–µ–æ–±—Ñ—É—Å–∫–∞—Ü–∏—è
    deobfuscated, err := engine.DeobfuscateData(obfuscated)
    if err != nil {
        log.Fatal(err)
    }
    
    log.Printf("Success: %s", string(deobfuscated))
}
```

## –ú–µ—Ç–æ–¥—ã –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏

### XOR Cipher

–ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π –º–µ—Ç–æ–¥ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º XOR –æ–ø–µ—Ä–∞—Ü–∏–∏.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
- –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- –¢—Ä–µ–±—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞ –∫–ª—é—á–∞–º–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```go
cipher, err := obfuscation.NewXORCipher([]byte("your-key"), logger)
```

### TLS Tunneling ‚úÖ

–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è VPN —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ TLS —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –í—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –æ–±—ã—á–Ω—ã–π HTTPS —Ç—Ä–∞—Ñ–∏–∫
- –°–ª–æ–∂–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Å–µ–≥–æ HTTPS
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SNI –∏ ALPN
- –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–¥–¥–µ–ª—å–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```go
config := &obfuscation.TLSTunnelConfig{
    ServerName:      "secure.example.com",
    ALPN:            []string{"h2", "http/1.1"},
    FakeHTTPHeaders: true,
}
tunnel, err := obfuscation.NewTLSTunnel(config, logger)
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [TLS Tunneling](tls_tunneling.md)

### Packet Padding ‚úÖ

–†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ó–∞—Ç—Ä—É–¥–Ω—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞
- –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–µ —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã padding'–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ padding'–∞

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```go
config := &obfuscation.PacketPaddingConfig{
    Enabled:       true,
    MinPadding:    10,
    MaxPadding:    100,
    RandomizeSize: true,
}
padding, err := obfuscation.NewPacketPadding(config, logger)
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [Packet Padding](packet_padding.md)

### HTTP Mimicry (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

–ú–∞—Å–∫–∏—Ä–æ–≤–∫–∞ VPN —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ–¥ –æ–±—ã—á–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ò–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –≤–µ–±-—Å–∞–π—Ç—ã
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ User-Agent –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö HTTP –º–µ—Ç–æ–¥–æ–≤

## –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏

### –ö–∏—Ç–∞–π (china)

–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ–±—Ö–æ–¥–∞ –í–µ–ª–∏–∫–æ–≥–æ –ö–∏—Ç–∞–π—Å–∫–æ–≥–æ –§–∞–π—Ä–≤–æ–ª–∞:
- –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥: TLS Tunnel
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã: HTTP Mimicry, XOR Cipher
- –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –ø–∞–∫–µ—Ç–æ–≤
- –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ (–ø–æ—Ä–æ–≥: 2 –æ—à–∏–±–∫–∏)

### –ò—Ä–∞–Ω (iran)

–ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –æ–±—Ö–æ–¥–∞ –∏—Ä–∞–Ω—Å–∫–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤:
- –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥: HTTP Mimicry
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã: TLS Tunnel, HTTP Steganography
- –£–º–µ—Ä–µ–Ω–Ω–∞—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è
- –°—Ä–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è (3 –æ—à–∏–±–∫–∏)

### –†–æ—Å—Å–∏—è (russia)

–°—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ–±—Ö–æ–¥–µ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö DPI:
- –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥: TLS Tunnel
- –†–µ–∑–µ—Ä–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã: HTTP Mimicry, Timing Obfuscation
- –õ–µ–≥–∫–∞—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
- –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è (4 –æ—à–∏–±–∫–∏)

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º:

- `connection reset by peer`
- `connection refused`
- `timeout`
- `certificate verify failed`
- `handshake failure`
- `protocol error`
- `unexpected EOF`
- `no route to host`

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—à–∏–±–æ–∫ –ø–æ–¥—Ä—è–¥ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `SwitchThreshold`), —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –º–µ—Ç–æ–¥ –∏–∑ —Å–ø–∏—Å–∫–∞ `FallbackMethods`.

## –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ö–∞–∂–¥—ã–π –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

```go
type ObfuscatorMetrics struct {
    PacketsProcessed int64         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
    BytesProcessed   int64         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –±–∞–π—Ç
    Errors           int64         // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
    AvgProcessTime   time.Duration // –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
    LastUsed         time.Time     // –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
}
```

–î–≤–∏–∂–æ–∫ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:

```go
type EngineMetrics struct {
    TotalPackets     int64                            // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤
    TotalBytes       int64                            // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç
    MethodSwitches   int64                            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –º–µ—Ç–æ–¥–æ–≤
    DetectionEvents  int64                            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
    MethodMetrics    map[ObfuscationMethod]*ObfuscatorMetrics // –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ –º–µ—Ç–æ–¥–∞–º
    StartTime        time.Time                        // –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞
}
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –±–µ–Ω—á–º–∞—Ä–∫–æ–≤ –Ω–∞ Apple M3 Pro:

```
BenchmarkXORObfuscation-12           1266703     944.6 ns/op     1408 B/op     1 allocs/op
BenchmarkTLSTunnelObfuscation-12    13643611      86.85 ns/op        0 B/op     0 allocs/op
BenchmarkHTTPMimicryObfuscation-12   1798338     672.1 ns/op     3494 B/op    15 allocs/op
BenchmarkPacketPaddingObfuscation-12 2734774     447.9 ns/op     2304 B/op     1 allocs/op
```

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–µ—Ç–æ–¥–æ–≤

1. **TLS Tunneling**: –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π (86.85 ns/op, 0 –∞–ª–ª–æ–∫–∞—Ü–∏–π)
2. **Packet Padding**: –•–æ—Ä–æ—à–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (447.9 ns/op, 1 –∞–ª–ª–æ–∫–∞—Ü–∏—è)
3. **HTTP Mimicry**: –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å (672.1 ns/op, 15 –∞–ª–ª–æ–∫–∞—Ü–∏–π)
4. **XOR Cipher**: –°–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π (944.6 ns/op, 1 –∞–ª–ª–æ–∫–∞—Ü–∏—è)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- `EnabledMethods` - —Å–ø–∏—Å–æ–∫ –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏
- `PrimaryMethod` - –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏
- `FallbackMethods` - —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- `AutoDetection` - –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- `SwitchThreshold` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞
- `DetectionTimeout` - —Ç–∞–π–º–∞—É—Ç –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- `RegionalProfile` - —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (china, iran, russia)

### –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

#### XOR Cipher
- `XORKey` - –∫–ª—é—á –¥–ª—è XOR –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ (–±–∞–π—Ç–æ–≤—ã–π –º–∞—Å—Å–∏–≤)

#### TLS Tunnel
- `ServerName` - –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è SNI
- `ALPN` - —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- `FakeHTTPHeaders` - –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–¥–¥–µ–ª—å–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏

#### Packet Padding
- `Enabled` - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å Packet Padding
- `MinPadding` - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- `MaxPadding` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è  
- `RandomizeSize` - —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä padding'–∞

#### HTTP Mimicry
- `UserAgent` - —Å—Ç—Ä–æ–∫–∞ User-Agent
- `FakeHost` - –ø–æ–¥–¥–µ–ª—å–Ω—ã–π —Ö–æ—Å—Ç
- `CustomHeaders` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏
- `MimicWebsite` - –≤–µ–±-—Å–∞–π—Ç –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π:

```bash
go run examples/obfuscation_demo.go
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –º–æ–¥—É–ª—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏:

```bash
go test ./pkg/obfuscation -v
```

### –ë–µ–Ω—á–º–∞—Ä–∫–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```bash
go test ./pkg/obfuscation -bench=. -v
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏** - –¥–ª—è XOR –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª—É—á–∞–π–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª–∏–Ω–æ–π –Ω–µ –º–µ–Ω–µ–µ 32 –±–∞–π—Ç
2. **–†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ –∫–ª—é—á–∏** - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∫–ª—é—á–∏ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏
3. **–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ –º–µ—Ç–æ–¥—ã** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å—Ç–æ–π–∫–æ—Å—Ç–∏
4. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π –º–µ—Ç–æ–¥–æ–≤ –∏ –æ—à–∏–±–æ–∫

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- XOR –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–æ–π –∏ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–≤–µ—Ä—Ö –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è VPN
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –º–æ–≥—É—Ç —Å–Ω–∏–∂–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ —Ä–µ–≥–∏–æ–Ω–µ

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞ –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏

1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Obfuscator`:

```go
type Obfuscator interface {
    Name() ObfuscationMethod
    Obfuscate(data []byte) ([]byte, error)
    Deobfuscate(data []byte) ([]byte, error)
    WrapConn(conn net.Conn) (net.Conn, error)
    IsAvailable() bool
    GetMetrics() ObfuscatorMetrics
}
```

2. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É –º–µ—Ç–æ–¥–∞:

```go
const MethodYourMethod ObfuscationMethod = "your_method"
```

3. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –≤ `initializeObfuscators()`:

```go
case MethodYourMethod:
    obfuscator, err = NewYourMethod(&e.config.YourMethodConfig, e.logger)
```

4. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã –≤ `obfuscation_test.go`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
pkg/obfuscation/
‚îú‚îÄ‚îÄ obfuscation.go      # –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å —Å –¥–≤–∏–∂–∫–æ–º –∏ XOR –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä–æ–º
‚îú‚îÄ‚îÄ obfuscation_test.go # –¢–µ—Å—Ç—ã –º–æ–¥—É–ª—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –ø—Ä–æ–µ–∫—Ç–∞ GoVPN –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ —Ç–æ–π –∂–µ –ª–∏—Ü–µ–Ω–∑–∏–µ–π. 